import torch
import torch.nn as nn

class StrokeEncoder(nn.Module):
    def __init__(
        self, 
        input_dim = 4,
        hidden_size = 512, 
        latent_dim = 256, 
        num_layers = 2
    ):
        super().__init__()
        
        # Bi-directional LSTM to process the sequence from both directions
        self.model = nn.LSTM(
            input_size = input_dim,
            hidden_size = hidden_size,
            num_layers = num_layers,
            bidirectional = True,
            batch_first = True
        )
        
        output_size = 2 * hidden_size
        
        self.mean_dist = nn.Linear(output_size, latent_dim)
        self.log_var = nn.Linear(output_size, latent_dim)

    def forward(self, stroke_seq):
        # stroke_seq shape: (Batch_size, Sequence_Length, INPUT_DIM)

        h_s = self.model(stroke_seq)[1][0] # Final hidden state

        final_forward = h_s[-2]
        final_backward = h_s[-1]
        final_state = torch.cat([final_forward, final_backward], dim = 1)

        mean_dist = self.mean_dist(final_state)
        log_var = self.log_var(final_state)
        
        return mean_dist, log_var

    def reparameterize(self, mean_dist, log_var):
        # https://medium.com/data-science/reparameterization-trick-126062cfd3c3
        std = torch.exp(0.5 * log_var)
        eps = torch.randn_like(std)
        
        return mean_dist + eps * std

seq = [[129.0, 80.0, 0.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [29.0, -36.0, 0.0, 1.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 2.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 2.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 2.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [54.0, -134.0, 0.0, 1.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [10.0, -27.0, 0.0, 1.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, -1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, -1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [2.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, -1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-42.0, -5.0, 0.0, 1.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 2.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 2.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, -1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, -1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, -1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, -1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, -1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, -1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, -1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, -1.0, 1.0, 0.0], [-2.0, -55.0, 0.0, 1.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 2.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [-1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, -1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, -1.0, 1.0, 0.0], [67.0, -31.0, 0.0, 1.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [0.0, 1.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0], [1.0, 0.0, 1.0, 0.0]]
seq = torch.tensor(seq, dtype = torch.float32)
seq = seq.unsqueeze(0)

model = StrokeEncoder()
mean, log_var = model(seq)
z = model.reparameterize(mean, log_var)

print(f"Mean ({mean.shape})", mean)
print(f"Log var ({log_var.shape})", log_var)
print(f"Latent z ({z.shape})", z)